var _0xd9b5=["\x26\x71\x75\x6F\x74\x3B","\x72\x65\x70\x6C\x61\x63\x65","\x26\x67\x74\x3B","\x26\x6C\x74\x3B","\x26\x61\x6D\x70\x3B","\x6A\x6F\x69\x6E","\x73\x70\x6C\x69\x74","\x6C\x65\x6E\x67\x74\x68","\x63\x68\x61\x72\x43\x6F\x64\x65\x41\x74","","\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65","\x70\x75\x73\x68","\x73\x75\x62\x73\x74\x72","\x72\x61\x6E\x64\x6F\x6D","\x66\x6C\x6F\x6F\x72","\x30","\x25\x34\x30","\x25\x32\x46","\x25\x32\x41","\x2B","\x25\x32\x42","\x20","\x75\x6E\x64\x65\x66\x69\x6E\x65\x64","\x73\x6C\x69\x63\x65","\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4A\x4B\x4C\x4D\x4E\x4F\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5A\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6A\x6B\x6C\x6D\x6E\x6F\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7A\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2B\x2F\x3D","\x63\x68\x61\x72\x41\x74","\x3D\x3D\x3D","\x69\x6E\x64\x65\x78\x4F\x66","\x25\x32\x39","\x25\x32\x38","\x25\x32\x37","\x25\x32\x31","\x77\x68\x69\x63\x68","\x6B\x65\x79\x43\x6F\x64\x65","\x74\x6F\x55\x70\x70\x65\x72\x43\x61\x73\x65","\x74\x6F\x4C\x6F\x77\x65\x72\x43\x61\x73\x65","\x61\x70\x70\x6C\x79","\x74\x6F\x53\x74\x72\x69\x6E\x67","\x70\x72\x6F\x74\x6F\x74\x79\x70\x65","\x5B\x6F\x62\x6A\x65\x63\x74\x20\x41\x72\x72\x61\x79\x5D","\x6F\x62\x6A\x65\x63\x74","\x22","\x22\x3A","\x6E\x75\x6D\x62\x65\x72","\x66\x61\x6C\x73\x65","\x74\x72\x75\x65","\x2C","\x5B","\x5D","\x7B","\x7D","\x7B\x0D\x0A","\x73\x74\x72\x69\x6E\x67","\x3A\x20","\x3B\x20\x0D\x0A","\x3A\x20\x7B\x20\x0D\x0A"];function _htmlEntities(_0xd186x2){return String(_0xd186x2)[_0xd9b5[1]](/&/g,_0xd9b5[4])[_0xd9b5[1]](/</g,_0xd9b5[3])[_0xd9b5[1]](/>/g,_0xd9b5[2])[_0xd9b5[1]](/"/g,_0xd9b5[0]);} ;function str_replace(_0xd186x4,_0xd186x5,_0xd186x2){return _0xd186x2[_0xd9b5[6]](_0xd186x4)[_0xd9b5[5]](_0xd186x5);} ;function _fromStringToBytes(_0xd186x7){var _0xd186x8=28;var _0xd186x9=1<<_0xd186x8,_0xd186x4=_0xd186x9-1,_0xd186xa=_0xd186x9>>1,_0xd186xb=_0xd186x8>>1,_0xd186xc=(1<<_0xd186xb)-1;var _0xd186x5=1,_0xd186x2=[0],_0xd186xd=0,_0xd186xe=0,_0xd186xf=256;var _0xd186x10=_0xd186x7[_0xd9b5[7]]*8;for(var _0xd186x11=0;_0xd186x11<_0xd186x10;_0xd186x11++){if((_0xd186xf<<=1)>255){_0xd186xf=1;c=_0xd186x7[_0xd9b5[8]](_0xd186xe++);} ;ifx(_0xd186x5>_0xd186x4);_0xd186x5=1;_0xd186x2[++_0xd186xd]=0;if(c&_0xd186xf){_0xd186x2[_0xd186xd]|=_0xd186x5;} ;_0xd186x5<<=1;} ;return _0xd186x2;} ;function _fromBytesToString(_0xd186x8){var _0xd186x13=28;var _0xd186xb=1<<_0xd186x13,_0xd186xe=_0xd186xb-1,_0xd186x10=_0xd186xb>>1,_0xd186xf=_0xd186x13>>1,_0xd186x7=(1<<_0xd186xf)-1;var _0xd186x11=1,_0xd186xc=0,_0xd186x2=[0],_0xd186x4=1,_0xd186xa=0;var _0xd186x14=_0xd186x8[_0xd9b5[7]]*_0xd186x13;var _0xd186x9,_0xd186xd=_0xd9b5[9];for(_0xd186x9=0;_0xd186x9<_0xd186x14;_0xd186x9++){if(_0xd186x8[_0xd186xc]&_0xd186x11){_0xd186x2[_0xd186xa]|=_0xd186x4;} ;if((_0xd186x4<<=1)>255){_0xd186x4=1;_0xd186x2[++_0xd186xa]=0;} ;if((_0xd186x11<<=1)>_0xd186xe){_0xd186x11=1;_0xd186xc++;} ;} ;while(_0xd186xa>=0&&_0xd186x2[_0xd186xa]==0){_0xd186xa--;} ;for(_0xd186x9=0;_0xd186x9<=_0xd186xa;_0xd186x9++){_0xd186xd+=String[_0xd9b5[10]](_0xd186x2[_0xd186x9]);} ;return _0xd186xd;} ;function _byteArray2String(_0xd186x2){var _0xd186x11=_0xd9b5[9];for(var _0xd186x4=0;_0xd186x4<_0xd186x2[_0xd9b5[7]];_0xd186x4++){_0xd186x11+=String[_0xd9b5[10]](_0xd186x2[_0xd186x4]);} ;return _0xd186x11;} ;function _bytesToHex(_0xd186x2){for(var _0xd186x4=[],_0xd186x5=0;_0xd186x5<_0xd186x2[_0xd9b5[7]];_0xd186x5++){_0xd186x4[_0xd9b5[11]]((_0xd186x2[_0xd186x5]>>>4).toString(16));_0xd186x4[_0xd9b5[11]]((_0xd186x2[_0xd186x5]&15).toString(16));} ;return _0xd186x4[_0xd9b5[5]](_0xd9b5[9]);} ;function _hexToBytes(_0xd186x5){for(var _0xd186x2=[],_0xd186x4=0;_0xd186x4<_0xd186x5[_0xd9b5[7]];_0xd186x4+=2){_0xd186x2[_0xd9b5[11]](parseInt(_0xd186x5[_0xd9b5[12]](_0xd186x4,2),16));} ;return _0xd186x2;} ;function _getRandomBytes(_0xd186x2){if(!_0xd186x2){_0xd186x2=8;} ;var _0xd186x5= new Array(_0xd186x2);var _0xd186x11=[],_0xd186x4=0;for(_0xd186x4=0;_0xd186x4<256;_0xd186x4++){_0xd186x11[_0xd186x4]=_0xd186x4;} ;for(_0xd186x4=0;_0xd186x4<_0xd186x5[_0xd9b5[7]];_0xd186x4++){_0xd186x5[_0xd186x4]=_0xd186x11[Math[_0xd9b5[14]](Math[_0xd9b5[13]]()*_0xd186x11[_0xd9b5[7]])];} ;return _0xd186x5;} ;function _fromHexToString(_0xd186x5){var _0xd186x4=_0xd9b5[9];for(var _0xd186x2=0;_0xd186x2<_0xd186x5[_0xd9b5[7]];_0xd186x2+=2){_0xd186x4+=String[_0xd9b5[10]](parseInt(_0xd186x5[_0xd9b5[12]](_0xd186x2,2),16));} ;return _0xd186x4;} ;function _fromStringToHex(_0xd186x11){if(!_0xd186x11){_0xd186x11=_0xd9b5[9];} ;var _0xd186x4=0,_0xd186x5=_0xd9b5[9],_0xd186x2=_0xd9b5[9];for(_0xd186x4=0;_0xd186x4<_0xd186x11[_0xd9b5[7]];_0xd186x4++){_0xd186x2=_0xd186x11[_0xd9b5[8]](_0xd186x4).toString(16);_0xd186x5+=(_0xd186x2[_0xd9b5[7]]==1)?_0xd9b5[15]+_0xd186x2:_0xd186x2;} ;return _0xd186x5;} ;function urlencode(_0xd186x2){return escape(_0xd186x2)[_0xd9b5[1]](/\+/g,_0xd9b5[20])[_0xd9b5[1]](/%20/g,_0xd9b5[19])[_0xd9b5[1]](/\*/g,_0xd9b5[18])[_0xd9b5[1]](/\//g,_0xd9b5[17])[_0xd9b5[1]](/@/g,_0xd9b5[16]);} ;function urldecode(_0xd186x2){return unescape(_0xd186x2[_0xd9b5[1]](/\+/g,_0xd9b5[21]));} ;function utf8_encode(_0xd186x2){if(_0xd186x2===null|| typeof _0xd186x2===_0xd9b5[22]){return _0xd9b5[9];} ;var _0xd186xb=(_0xd186x2+_0xd9b5[9]);var _0xd186xa=_0xd9b5[9],_0xd186x5,_0xd186xe,_0xd186x4=0;_0xd186x5=_0xd186xe=0;_0xd186x4=_0xd186xb[_0xd9b5[7]];for(var _0xd186x11=0;_0xd186x11<_0xd186x4;_0xd186x11++){var _0xd186xd=_0xd186xb[_0xd9b5[8]](_0xd186x11);var _0xd186x9=null;if(_0xd186xd<128){_0xd186xe++;} else {if(_0xd186xd>127&&_0xd186xd<2048){_0xd186x9=String[_0xd9b5[10]]((_0xd186xd>>6)|192)+String[_0xd9b5[10]]((_0xd186xd&63)|128);} else {_0xd186x9=String[_0xd9b5[10]]((_0xd186xd>>12)|224)+String[_0xd9b5[10]](((_0xd186xd>>6)&63)|128)+String[_0xd9b5[10]]((_0xd186xd&63)|128);} ;} ;if(_0xd186x9!==null){if(_0xd186xe>_0xd186x5){_0xd186xa+=_0xd186xb[_0xd9b5[23]](_0xd186x5,_0xd186xe);} ;_0xd186xa+=_0xd186x9;_0xd186x5=_0xd186xe=_0xd186x11+1;} ;} ;if(_0xd186xe>_0xd186x5){_0xd186xa+=_0xd186xb[_0xd9b5[23]](_0xd186x5,_0xd186x4);} ;return _0xd186xa;} ;function utf8_decode(_0xd186x2){var _0xd186x4=[],_0xd186xe=0,_0xd186xd=0,_0xd186x9=0,_0xd186x11=0,_0xd186x5=0;_0xd186x2+=_0xd9b5[9];while(_0xd186xe<_0xd186x2[_0xd9b5[7]]){_0xd186x9=_0xd186x2[_0xd9b5[8]](_0xd186xe);if(_0xd186x9<128){_0xd186x4[_0xd186xd++]=String[_0xd9b5[10]](_0xd186x9);_0xd186xe++;} else {if(_0xd186x9>191&&_0xd186x9<224){_0xd186x11=_0xd186x2[_0xd9b5[8]](_0xd186xe+1);_0xd186x4[_0xd186xd++]=String[_0xd9b5[10]](((_0xd186x9&31)<<6)|(_0xd186x11&63));_0xd186xe+=2;} else {_0xd186x11=_0xd186x2[_0xd9b5[8]](_0xd186xe+1);_0xd186x5=_0xd186x2[_0xd9b5[8]](_0xd186xe+2);_0xd186x4[_0xd186xd++]=String[_0xd9b5[10]](((_0xd186x9&15)<<12)|((_0xd186x11&63)<<6)|(_0xd186x5&63));_0xd186xe+=3;} ;} ;} ;return _0xd186x4[_0xd9b5[5]](_0xd9b5[9]);} ;function base64_encode(_0xd186xf){var _0xd186xe=_0xd9b5[24];var _0xd186x11,_0xd186x4,_0xd186x5,_0xd186x8,_0xd186x20,_0xd186x10,_0xd186xc,_0xd186x7,_0xd186xa=0,_0xd186x14=0,_0xd186xd=_0xd9b5[9],_0xd186x9=[];if(!_0xd186xf){return _0xd186xf;} ;do{_0xd186x11=_0xd186xf[_0xd9b5[8]](_0xd186xa++);_0xd186x4=_0xd186xf[_0xd9b5[8]](_0xd186xa++);_0xd186x5=_0xd186xf[_0xd9b5[8]](_0xd186xa++);_0xd186x7=_0xd186x11<<16|_0xd186x4<<8|_0xd186x5;_0xd186x8=_0xd186x7>>18&63;_0xd186x20=_0xd186x7>>12&63;_0xd186x10=_0xd186x7>>6&63;_0xd186xc=_0xd186x7&63;_0xd186x9[_0xd186x14++]=_0xd186xe[_0xd9b5[25]](_0xd186x8)+_0xd186xe[_0xd9b5[25]](_0xd186x20)+_0xd186xe[_0xd9b5[25]](_0xd186x10)+_0xd186xe[_0xd9b5[25]](_0xd186xc);} while(_0xd186xa<_0xd186xf[_0xd9b5[7]]);;_0xd186xd=_0xd186x9[_0xd9b5[5]](_0xd9b5[9]);var _0xd186x2=_0xd186xf[_0xd9b5[7]]%3;return (_0xd186x2?_0xd186xd[_0xd9b5[23]](0,_0xd186x2-3):_0xd186xd)+_0xd9b5[26][_0xd9b5[23]](_0xd186x2||3);} ;function base64_decode(_0xd186xa){var _0xd186x11=_0xd9b5[24];var _0xd186x4,_0xd186x5,_0xd186x2,_0xd186x20,_0xd186x10,_0xd186xc,_0xd186xf,_0xd186x8,_0xd186xd=0,_0xd186x7=0,_0xd186xe=_0xd9b5[9],_0xd186x9=[];if(!_0xd186xa){return _0xd186xa;} ;_0xd186xa+=_0xd9b5[9];do{_0xd186x20=_0xd186x11[_0xd9b5[27]](_0xd186xa[_0xd9b5[25]](_0xd186xd++));_0xd186x10=_0xd186x11[_0xd9b5[27]](_0xd186xa[_0xd9b5[25]](_0xd186xd++));_0xd186xc=_0xd186x11[_0xd9b5[27]](_0xd186xa[_0xd9b5[25]](_0xd186xd++));_0xd186xf=_0xd186x11[_0xd9b5[27]](_0xd186xa[_0xd9b5[25]](_0xd186xd++));_0xd186x8=_0xd186x20<<18|_0xd186x10<<12|_0xd186xc<<6|_0xd186xf;_0xd186x4=_0xd186x8>>16&255;_0xd186x5=_0xd186x8>>8&255;_0xd186x2=_0xd186x8&255;if(_0xd186xc==64){_0xd186x9[_0xd186x7++]=String[_0xd9b5[10]](_0xd186x4);} else {if(_0xd186xf==64){_0xd186x9[_0xd186x7++]=String[_0xd9b5[10]](_0xd186x4,_0xd186x5);} else {_0xd186x9[_0xd186x7++]=String[_0xd9b5[10]](_0xd186x4,_0xd186x5,_0xd186x2);} ;} ;} while(_0xd186xd<_0xd186xa[_0xd9b5[7]]);;_0xd186xe=_0xd186x9[_0xd9b5[5]](_0xd9b5[9]);return _0xd186xe;} ;function rawurlencode(_0xd186x2){_0xd186x2=(_0xd186x2+_0xd9b5[9]).toString();return encodeURIComponent(_0xd186x2)[_0xd9b5[1]](/!/g,_0xd9b5[31])[_0xd9b5[1]](/'/g,_0xd9b5[30])[_0xd9b5[1]](/\(/g,_0xd9b5[29])[_0xd9b5[1]](/\)/g,_0xd9b5[28])[_0xd9b5[1]](/\*/g,_0xd9b5[18]);} ;function rawurldecode(_0xd186x2){return decodeURIComponent(_0xd186x2+_0xd9b5[9]);} ;function rand(_0xd186x2){return (Math[_0xd9b5[14]](Math[_0xd9b5[13]]()*_0xd186x2+1));} ;function isNumberKey(_0xd186x5){var _0xd186x2=(_0xd186x5[_0xd9b5[32]])?_0xd186x5[_0xd9b5[32]]:event[_0xd9b5[33]];if((_0xd186x2>31)&&(_0xd186x2<48||_0xd186x2>57)){return false;} ;return true;} ;function toupper(_0xd186x2){return _0xd186x2[_0xd9b5[34]]();} ;function tolower(_0xd186x2){return _0xd186x2[_0xd9b5[35]]();} ;function array2json(_0xd186x2){var _0xd186x9=[];var _0xd186x5=(Object[_0xd9b5[38]][_0xd9b5[37]][_0xd9b5[36]](_0xd186x2)===_0xd9b5[39]);for(var _0xd186x11 in _0xd186x2){var _0xd186xe=_0xd186x2[_0xd186x11];if( typeof _0xd186xe==_0xd9b5[40]){if(_0xd186x5){_0xd186x9[_0xd9b5[11]](array2json(_0xd186xe));} else {_0xd186x9[_0xd186x11]=array2json(_0xd186xe);} ;} else {var _0xd186xd=_0xd9b5[9];if(!_0xd186x5){_0xd186xd=_0xd9b5[41]+_0xd186x11+_0xd9b5[42];} ;if( typeof _0xd186xe==_0xd9b5[43]){_0xd186xd+=_0xd186xe;} else {if(_0xd186xe===false){_0xd186xd+=_0xd9b5[44];} else {if(_0xd186xe===true){_0xd186xd+=_0xd9b5[45];} else {_0xd186xd+=_0xd9b5[41]+_0xd186xe+_0xd9b5[41];} ;} ;} ;_0xd186x9[_0xd9b5[11]](_0xd186xd);} ;} ;var _0xd186x4=_0xd186x9[_0xd9b5[5]](_0xd9b5[46]);if(_0xd186x5){return _0xd9b5[47]+_0xd186x4+_0xd9b5[48];} ;return _0xd9b5[49]+_0xd186x4+_0xd9b5[50];} ;function printObj(_0xd186x4){var _0xd186x5=_0xd9b5[51];for(var _0xd186x2 in _0xd186x4){if( typeof _0xd186x4[_0xd186x2]==_0xd9b5[52]){_0xd186x5+=_0xd186x2+_0xd9b5[53]+_0xd186x4[_0xd186x2]+_0xd9b5[54];} else {_0xd186x5+=_0xd186x2+_0xd9b5[55]+printObj(_0xd186x4[_0xd186x2])+_0xd9b5[50];} ;} ;_0xd186x5+=_0xd9b5[50];return _0xd186x5;} ;
var _keySizeInBits=512; // default keyLength

function isValidKey(a){
    a=parseInt(a);
    if((a==128)||(a==256)||(a==512)||(a==1024)||(a==2048)){
        return true
    }return false
};


 /*
  * RSA		
  */
function _encrypt(plaintext, pkey) 
{
    // *init var
    var cipher, status;
	var t1, t2, time;
	var ciphertext;
	var msg_status = "success", flag_status=0;
	
	var mod = new Array();
	var exp = new Array();
	 
	//var pkey = document.getElementById("pkey").value;
	var s = r2s(pkey);
	var l = Math.floor((s.charCodeAt(0)*256 + s.charCodeAt(1)+7)/8);

    mod = mpi2b(s.substr(0,l+2)); // modulo (p*q)
	exp = mpi2b(s.substr(l+2));   // esponente pubblico
	
	var p = plaintext + String.fromCharCode(1);
	var pl = p.length;

	if(pl > l-3)
	{
	   alert('In this example plain text length must be less than modulus of '+(l-3)+' bytes');
	  return;
	}

	// encrypt
	try {
	    t1 = new Date().getTime();
	    
		var b = s2b(p);
		var enc = RSAencrypt(b, exp, mod);
		ciphertext = s2hex(b2s(enc));
		
	    t2 = new Date().getTime();
	    time = (t2 - t1);
	}
	catch(e){
		var msg="";
		alert("Can't encrypt (OpenPGP): RSAencrypt: " + msg);
	  flag_status=1;
	}
	
	if (flag_status != 0) {
	  msg_status = "failure";
	}

   	// array json object
	var json;
	json = {
			keySize: _keySizeInBits,
			cipher: "rsa",
			ciphertext: base64_encode(ciphertext),
			time: time,
			status: msg_status
		   };
		   
   return (json);
}
 
function _decrypt(json_ciphertext, p, q, d, u) 
{
    // *init var
	var jsObject;
    var cipher, status;
	var t1, t2, time;
	var plaintext, ciphertext;
	var msg_status = "success", flag_status=0;
	
	// 1° check
    try {
	json_ciphertext = json_ciphertext.trim();
	// da json_string a json_data_object
	//jsObject = eval("(" + json_ciphertext + ")");
	jsObject = JSON.parse(json_ciphertext);
	if (jsObject == null) {
	  alert("Can't decrypt: INVALID: json decrypt: invalid object");
	  flag_status=1;
	}
	//console.log(jsObject);
	//return jsObject;
    }catch(e){
	   alert("Can't decrypt: INVALID: json decrypt: " + e.message);
	  flag_status=1;
    }
	
	// 2° check
	if (flag_status==0){
	    // jsObject
		status = jsObject.status;
		cipher = jsObject.cipher;
		ciphertext = base64_decode(jsObject.ciphertext);
		keySize = jsObject.keySize;
	
		if (status != "success") {
		  alert("Can't decrypt: INVALID: json decrypt: invalid parameters");
		  flag_status=1;
		}
		if ((flag_status==0) && (cipher != "rsa")) {
		  alert("Can't decrypt: INVALID: json decrypt: invalid parameters");
		  flag_status=1;
		}
		if ((flag_status==0) && (ciphertext == undefined)) {
		  alert("Can't decrypt: CORRUPT: doesn't match 'ciphertext'");
		  flag_status=1;
		}
			
		if ((flag_status==0) && (keySize != _keySizeInBits)) {
		   alert("Can't decrypt: INVALID: json decrypt: invalid parameters");
		  flag_status=1;
		}
		
    } else { return null; }
 
    // parametri RSA (da hex ad array)
	/*var p = hexToArr(document.getElementById("p").value); // numero primo p
	var q = hexToArr(document.getElementById("q").value); // numero primo q
	var d = hexToArr(document.getElementById("d").value); // esponente privato
	var u = hexToArr(document.getElementById("u").value); // 1/Q*/

	try {
  	    t1 = new Date().getTime();
		  
		 var enc = s2b(hex2s(ciphertext));
  	     var dec = b2s(RSAdecrypt(enc, d, p, q, u));
	     plaintext = dec.substr(0, dec.length-1);
			
	    t2 = new Date().getTime();
	    time = (t2 - t1);
	}
	catch(e){
		var msg="";
		alert("Can't decrypt (OpenPGP): RSAdecrypt: " + msg)
	   flag_status=1;
	}
	
	if (flag_status != 0) {
	  msg_status = "failure";
	}
	 
	// array json object
	var json;
	json = {
			keySize: _keySizeInBits,
			cipher: "rsa",
			plaintext: plaintext,
			time: time,
			status: msg_status
	};
		
  return json;
}

function genkey(keySize)
{
    if (!keySize) { 
	if (document.getElementById("bits") != null) {
	    keySize = parseInt(document.getElementById("bits").value);
	} else {
	    keySize=_keySizeInBits;
	}
    } else {
	  /*if (document.getElementById("bits") != null) {
	    document.getElementById("bits").value=keySize;
	  }*/
    }
	
	// controllo sulla lunghezza della chiave!!!
    if (keySize > 2048) {
      alert("the calculation takes a long time!!!");
      //document.getElementById("bits").value=128;
      //objK = document.getElementById('selKeySize');
      //objK.value=128;   
      keySize=_keySizeInBits;
    }
	
	//print('Generating '+keySize+'-bit key-pair...'); // 'print' in IE conflitto
    var before = new Date().getTime();

	 rsaKeys(keySize); // generate rsa keys
	 
    var after = new Date().getTime();
    var time = (after - before);
	//document.getElementById("howLong").value = time;
	//print('Key-pair created.');
	
	/*document.getElementById("p").value  = arrToHex(rsa_p);
	document.getElementById("q").value  = arrToHex(rsa_q);
	document.getElementById("d").value  = arrToHex(rsa_d);
	document.getElementById("e").value  = arrToHex(rsa_e);
	document.getElementById("u").value  = arrToHex(rsa_u);
	document.getElementById("pq").value = arrToHex(rsa_pq);*/

	var mpi = s2r(b2mpi(rsa_pq)+b2mpi(rsa_e));
	mpi=mpi.replace(/\n/,'');
	//document.getElementById("pkey").value=mpi;
	
	if (isValidKey(keySize)) {
	    //var objK = document.getElementById('selKeySize');
	    //objK.value=keySize;   
	}
	_keySizeInBits = keySize;
	
    return {
	    p: (rsa_p),
	    q: (rsa_q),
	    d: (rsa_d),
	    e: (rsa_e),
	    u: (rsa_u),
	    pq: (rsa_pq),
	    pkey: mpi,
	    keySize: keySize
    };
}

function arrToHex(arr)
{
  return s2hex(b2s(arr));
}

function hexToArr(hex)
{
  return s2b(hex2s(hex));
}

function randomString(length){
    length = length || 120;
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_-+=<>,.?/;:";

    for( var i=0; i < length; i++ )
        text += possible.charAt(Math.floor(Math.random() * possible.length));

    return text;
}
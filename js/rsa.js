var bs=28;var bx2=1<<bs,bm=bx2-1,bx=bx2>>1,bd=bs>>1,bdm=(1<<bd)-1;var log2=Math.log(2);function zeros(b){var a=new Array(b);while(b-->0){a[b]=0}return a}function zclip(a){var b=a.length;if(a[b-1]){return a}while(b>1&&a[b-1]==0){b--}return a.slice(0,b)}function nbits(a){var c=1,b;if((b=a>>>16)!=0){a=b;c+=16}if((b=a>>8)!=0){a=b;c+=8}if((b=a>>4)!=0){a=b;c+=4}if((b=a>>2)!=0){a=b;c+=2}if((b=a>>1)!=0){a=b;c+=1}return c}function badd(e,d){var g=e.length;var j=d.length;if(g<j){return badd(d,e)}var f=new Array(g);var i=0,h=0;for(;h<j;h++){i+=e[h]+d[h];f[h]=i&bm;i>>>=bs}for(;h<g;h++){i+=e[h];f[h]=i&bm;i>>>=bs}if(i){f[h]=i}return f}function bsub(e,d){var g=e.length;var j=d.length;if(j>g){return[]}if(j==g){if(d[j-1]>e[j-1]){return[]}if(j==1){return[e[0]-d[0]]}}var f=new Array(g);var i=0;for(var h=0;h<j;h++){i+=e[h]-d[h];f[h]=i&bm;i>>=bs}for(;h<g;h++){i+=e[h];f[h]=i&bm;i>>=bs}if(i){return[]}return zclip(f)}function ip(o,a,k,i,h){var g=k&bdm;var j=k>>bd;var b=i&bdm;var f=i>>bd;var d=j*b+f*g;var e=g*b+((d&bdm)<<bd)+o[a]+h;o[a]=e&bm;h=j*f+(d>>bd)+(e>>bs);return h}function bsqr(a){var e=a.length;var h=2*e;var f=zeros(h);var g=0;var d,b;for(d=0;d<e;d++){g=ip(f,2*d,a[d],a[d],0);for(b=d+1;b<e;b++){g=ip(f,d+b,2*a[b],a[d],g)}f[d+e]=g}return zclip(f)}function bmul(a,k){var h=a.length;var e=k.length;var f=zeros(h+e-1);var g,d,b;for(d=0;d<e;d++){g=0;for(b=0;b<h;b++){g=ip(f,d+b,a[b],k[d],g)}f[d+h]=g}return zclip(f)}function toppart(b,d,a){var c=0;while(d>=0&&a-->0){c=c*bx2+b[d--]}return c}function bdiv(D,C){var r=D.length-1;var l=C.length-1;var k=r-l;if(r<l||r==l&&(D[r]<C[r]||r>0&&D[r]==C[r]&&D[r-1]<C[r-1])){this.q=[0];this.mod=D;return this}if(r==l&&toppart(D,l,2)/toppart(C,l,2)<4){var h=D.concat();var c=0;var f;for(;;){f=bsub(h,C);if(f.length==0){break}h=f;c++}this.q=[c];this.mod=h;return this}var z=Math.floor(Math.log(C[l])/log2)+1;var A=bs-z;var h=D.concat();var g=C.concat();if(A){for(w=l;w>0;w--){g[w]=((g[w]<<A)&bm)|(g[w-1]>>z)}g[0]=(g[0]<<A)&bm;if(h[r]&((bm<<z)&bm)){h[++r]=0;k++}for(w=r;w>0;w--){h[w]=((h[w]<<A)&bm)|(h[w-1]>>z)}h[0]=(h[0]<<A)&bm}var w,v,B;var p=zeros(k+1);var d=zeros(k).concat(g);for(;;){B=bsub(h,d);if(B.length==0){break}p[k]++;h=B}var u=g[l],o=toppart(g,l,2);for(w=r;w>l;w--){var s=w-l-1;if(w>=h.length){p[s]=1}else{if(h[w]==u){p[s]=bm}else{p[s]=Math.floor(toppart(h,w,2)/u)}}var e=toppart(h,w,3);while(p[s]*o>e){p[s]--}d=d.slice(1);B=bsub(h,bmul([p[s]],d));if(B.length==0){p[s]--;B=bsub(h,bmul([p[s]],d))}h=B}if(A){for(w=0;w<h.length-1;w++){h[w]=(h[w]>>A)|((h[w+1]<<z)&bm)}h[h.length-1]>>=A}this.q=zclip(p);this.mod=zclip(h);return this}function simplemod(d,a){var f=0,b;for(var e=d.length-1;e>=0;e--){b=d[e];f=((b>>bd)+(f<<bd))%a;f=((b&bdm)+(f<<bd))%a}return f}function bmod(c,a){if(a.length==1){if(c.length==1){return[c[0]%a[0]]}if(a[0]<bdm){return[simplemod(c,a[0])]}}var b=bdiv(c,a);return b.mod}function bmod2(i,e,l){var h=i.length-(e.length<<1);if(h>0){return bmod2(i.slice(0,h).concat(bmod2(i.slice(h),e,l)),e,l)}var k=e.length+1,j=e.length-1,f;var g=bmul(i.slice(j),l).slice(k);var d=i.slice(0,k);var b=bmul(g,e).slice(0,k);var a=bsub(d,b);if(a.length==0){d[k]=1;a=bsub(d,b)}for(var c=0;;c++){f=bsub(a,e);if(f.length==0){break}a=f;if(c>=3){return bmod2(a,e,l)}}return a}function bexpmod(f,h,b){var d=f.concat();var c=h.length-1;var i=nbits(h[c])-2;for(;c>=0;c--){for(;i>=0;i-=1){d=bmod(bsqr(d),b);if(h[c]&(1<<i)){d=bmod(bmul(d,f),b)}}i=bs-1}return d}function bmodexp(h,i,b){var f=h.concat();var d=i.length-1;var j=b.length*2;var c=zeros(j+1);c[j]=1;c=bdiv(c,b).q;j=nbits(i[d])-2;for(;d>=0;d--){for(;j>=0;j-=1){f=bmod2(bsqr(f),b,c);if(i[d]&(1<<j)){f=bmod2(bmul(f,h),b,c)}}j=bs-1}return f}function RSAencrypt(b,c,a){return bexpmod(b,c,a)}function RSAdecrypt(a,i,h,g,b){var f=bmodexp(bmod(a,h),bmod(i,bsub(h,[1])),h);var e=bmodexp(bmod(a,g),bmod(i,bsub(g,[1])),g);var c=bsub(e,f);if(c.length==0){c=bsub(f,e);c=bmod(bmul(c,b),g);c=bsub(g,c)}else{c=bmod(bmul(c,b),g)}return badd(bmul(c,h),f)}function mpi2b(k){var b=1,a=[0],f=0,i=256;var h,e=k.length;if(e<2){alert("string too short, not a MPI");return 0}var g=(e-2)*8;var j=k.charCodeAt(0)*256+k.charCodeAt(1);if(j>g||j<g-8){alert("not a MPI, bits="+j+",len="+g);return 0}for(var d=0;d<g;d++){if((i<<=1)>255){i=1;h=k.charCodeAt(--e)}if(b>bm){b=1;a[++f]=0}if(h&i){a[f]|=b}b<<=1}return a}function b2mpi(i){var d=1,h=0,a=[0],c=1,g=0;var j=i.length*bs;var e,f="";for(e=0;e<j;e++){if(i[h]&d){a[g]|=c}if((c<<=1)>255){c=1;a[++g]=0}if((d<<=1)>bm){d=1;h++}}while(g&&a[g]==0){g--}d=256;for(j=8;j>0;j--){if(a[g]&(d>>=1)){break}}j+=g*8;f+=String.fromCharCode(j/256)+String.fromCharCode(j%256);if(j){for(e=g;e>=0;e--){f+=String.fromCharCode(a[e])}}return f};